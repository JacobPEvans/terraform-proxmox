name: Claude Code Review

on:
  pull_request:
    types: [opened, synchronize]
  issue_comment:
    types: [created]

permissions:
  actions: read
  contents: read
  id-token: write
  issues: write
  pull-requests: write

concurrency:
  group: claude-review-${{ github.event.pull_request.number || github.event.issue.number || github.ref }}
  cancel-in-progress: true

jobs:
  review:
    uses: JacobPEvans/ai-workflows/.github/workflows/claude-review.yml@v0.3.1
    with:
      review_prompt: "Focus on Terraform best practices, security, SOPS/age patterns"
    secrets: inherit
